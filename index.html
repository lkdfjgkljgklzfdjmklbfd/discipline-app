<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>DISCIPLINE</title>
<style>
body {
  margin: 0;
  font-family: Arial, sans-serif;
  background: black;
  overflow: hidden;
  color: white;
}

/* Animated red candle background */
canvas {
  position: fixed;
  top: 0;
  left: 0;
  width: 100vw;
  height: 100vh;
  z-index: -1;
}

/* Center container */
#container {
  display: flex;
  justify-content: center;
  align-items: center;
  height: 100vh;
}

/* Card */
.card {
  background: rgba(10,10,10,0.95);
  padding: 40px;
  width: 520px;
  max-width: 95%;
  border-radius: 20px;
  box-shadow: 0 0 40px rgba(255,0,0,0.2);
  text-align: center;
}

/* Intro */
#intro h1 {
  font-size: 48px;
  letter-spacing: 6px;
  color: #ff1a1a;
  margin: 0;
}

#intro h2 {
  margin-top: 10px;
  letter-spacing: 4px;
  color: #aaa;
}

button {
  padding: 14px 24px;
  margin-top: 20px;
  border: none;
  border-radius: 12px;
  font-size: 15px;
  cursor: pointer;
  background: #b30000;
  color: white;
  transition: 0.2s;
}

button:hover {
  background: #ff1a1a;
}

.choice {
  background: #1a1a1a;
  margin: 12px 0;
  padding: 14px;
  border-radius: 12px;
  cursor: pointer;
  border: 2px solid transparent;
}

.choice.selected {
  border: 2px solid #ff1a1a;
}

.word-container {
  display: flex;
  flex-wrap: wrap;
  justify-content: center;
  margin: 15px 0;
  min-height: 50px;
}

.word {
  background: #990000;
  padding: 8px 14px;
  margin: 6px;
  border-radius: 10px;
  cursor: pointer;
  user-select: none;
}

#result {
  margin-top: 15px;
  font-weight: bold;
}

/* âœ… FIXED: streakBox had missing } before */
#streakBox {
  position: fixed;
  top: 20px;
  right: 20px;
  font-size: 14px;
  color: rgba(255,255,255,0.9);
  z-index: 9999;
}

/* Credit fixed bottom-right */
#credit {
  position: fixed;
  bottom: 20px;
  right: 25px;
  font-size: 12px;
  color: rgba(255,255,255,0.6);
  letter-spacing: 1px;
  font-weight: 500;
  z-index: 9999;
  pointer-events: none;
}

/* small hint line */
.hint {
  margin-top: 12px;
  color: #aaa;
  font-size: 13px;
}
</style>
</head>
<body>

<canvas id="bg"></canvas>
<div id="streakBox"></div>

<div id="container">
  <div class="card" id="intro">
    <h1>DISCIPLINE</h1>
    <h2>YOU VS YOU</h2>
    <button onclick="startGame()">START SESSION â†’</button>
    <p style="color: rgba(255,255,255,0.65); font-size: 12px; margin-top: 20px; letter-spacing: 1px;">
      made by Frihet
    </p>
  </div>
</div>

<div id="credit">made by Frihet</div>

<script>
/* Candle Background Animation */
const canvas = document.getElementById("bg");
const ctx = canvas.getContext("2d");

function resizeCanvas(){
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;
}
resizeCanvas();
window.addEventListener("resize", resizeCanvas);

let candles = [];
function initCandles(){
  candles = [];
  for (let i = 0; i < 40; i++) {
    candles.push({
      x: Math.random() * canvas.width,
      y: Math.random() * canvas.height,
      height: Math.random() * 60 + 20,
      speed: Math.random() * 1 + 0.5
    });
  }
}
initCandles();

function animate() {
  ctx.clearRect(0,0,canvas.width,canvas.height);
  candles.forEach(c => {
    ctx.fillStyle = "rgba(255,0,0,0.4)";
    ctx.fillRect(c.x, c.y, 6, c.height);
    c.y += c.speed;
    if (c.y > canvas.height) c.y = -c.height;
  });
  requestAnimationFrame(animate);
}
animate();

/* âœ… Data (English audio always, text changes by nativeLang) */
const items = [
  { en: "I feel you, bro. Iâ€™ve also been through a lot.", de: "Ich fÃ¼hl dich, Bro. Ich hab auch schon viel durchgemacht." },
  { en: "You donâ€™t need motivation. you just need discipline, bro.", de: "Du brauchst keine Motivation. Du brauchst Disziplin, Bro." },
  { en: "You just need to control yourself. itâ€™s you vs you, bro.", de: "Du musst dich einfach kontrollieren. Es geht nur um dich gegen dich, Bro." },
  { en: "I want you to succeed, bro. I believe in you.", de: "Ich will, dass du Erfolg hast, Bro. Ich glaub an dich." },
  { en: "But you know, someone has to do 9 to 5 stuff. Not everyone can be a millionaire.", de: "Aber weiÃŸt du, irgendwer muss halt den 9-to-5-Job machen. Nicht jeder wird MillionÃ¤r." },
  { en: "I know itâ€™s hard but dude nothing is easy in this world. You gotta work hard.", de: "Ich weiÃŸ, es ist hart, aber nichts auf dieser Welt ist leicht. Du musst hart arbeiten." },
  { en: "Go ghost, bro. You canâ€™t grow when people are around you.", de: "Zieh dich zurÃ¼ck, Bro. Du kannst nicht wachsen, wenn stÃ¤ndig Leute um dich herum sind." },
  { en: "Lock in. You wanna be rich or not?", de: "Fokussier dich. Willst du reich werden oder nicht?" },
  { en: "I donâ€™t wanna be an NPC, bro. Thatâ€™s why Iâ€™m working this hard.", de: "Ich will kein NPC sein, Bro. Deshalb arbeite ich so hart." },
  { en: "You think I enjoy going to the gym every day? Hell nah, bro. I genuinely donâ€™t.", de: "Denkst du, ich geh gern jeden Tag ins Gym? Hell nah, Bro. Ehrlich nicht." },
  { en: "You live only one life, bro. Nothing can stop you. do what you want.", de: "Du hast nur ein Leben, Bro. Nichts kann dich aufhalten. Mach, was du willst." },
  { en: "If you want big money, make a big move. You canâ€™t get rich with a 9 to 5 job, you know that.", de: "Wenn du groÃŸes Geld willst, musst du groÃŸe Moves machen. Mit einem 9-to-5-Job wirst du nicht reich, das weiÃŸt du." },
  { en: "If you wanna be different, you gotta be emotionless, bro. Learn to control your emotions", de: "Wenn du anders sein willst, musst du emotionslos sein, Bro. Lern, deine Emotionen zu kontrollieren." },
  { en: "Bro, everyoneâ€™s lost. Itâ€™s not just you. Weâ€™re all lost. Thatâ€™s the beauty of life", de: "Bro, jeder ist verloren. Nicht nur du. Wir sind alle verloren. Das ist das SchÃ¶ne am Leben." }
];

let used = [];
let currentIndex = 0;
let score = 0;
let round = 0;
let selectedChoice = null;
let audio = null;

let nativeLang = "en"; // "en" or "de"

const UI = {
  en: {
    chooseNative: "Choose your native language",
    audioNote: "Audio stays English. Text support changes.",
    play: "PLAY",
    check: "CHECK",
    listenDecide: "Listen & Decide",
    buildFocus: "Build With Focus",
    sessionComplete: "Session Complete",
    score: "Score",
    restart: "Restart"
  },
  de: {
    chooseNative: "WÃ¤hle deine Muttersprache",
    audioNote: "Audio bleibt Englisch. Der Text Ã¤ndert sich.",
    play: "PLAY",
    check: "PRÃœFEN",
    listenDecide: "HÃ¶ren & Entscheiden",
    buildFocus: "Satz bauen",
    sessionComplete: "Session beendet",
    score: "Punktzahl",
    restart: "Neustart"
  }
};

function t(key) {
  return (UI[nativeLang] && UI[nativeLang][key]) ? UI[nativeLang][key] : UI.en[key];
}

function displayText(i){
  return nativeLang === "de" ? items[i].de : items[i].en;
}

/* Daily Streak */
function updateStreak() {
  let today = new Date().toDateString();
  let last = localStorage.getItem("lastDate");
  let streak = parseInt(localStorage.getItem("streak") || "0");

  if (last !== today) {
    let yesterday = new Date();
    yesterday.setDate(yesterday.getDate() - 1);
    if (last === yesterday.toDateString()) {
      streak++;
    } else {
      streak = 1;
    }
    localStorage.setItem("streak", streak);
    localStorage.setItem("lastDate", today);
  }

  document.getElementById("streakBox").innerText = "ðŸ”¥ Streak: " + (localStorage.getItem("streak") || 1);
}
updateStreak();

/* Start -> language select */
function startGame() {
  document.getElementById("container").innerHTML =
    `
    <div class="card">
      <h2 style="margin-top:0;">${t("chooseNative")}</h2>
      <p style="color:#aaa; margin-top:8px;">${t("audioNote")}</p>

      <button onclick="chooseLang('en')">ðŸ‡¬ðŸ‡§ English</button>
      <button onclick="chooseLang('de')" style="margin-left:10px;">ðŸ‡©ðŸ‡ª Deutsch</button>

      <p style="color: rgba(255,255,255,0.65); font-size: 12px; margin-top: 20px; letter-spacing: 1px;">
        made by Frihet
      </p>
    </div>
    `;
}

function chooseLang(lang) {
  nativeLang = lang;

  document.getElementById("container").innerHTML =
    `<div class="card">
       <h2 id="mode"></h2>
       <button onclick="playAudio()">${t("play")}</button>
       <div id="content"></div>
       <div id="result"></div>
     </div>`;

  used = [];
  score = 0;
  round = 0;
  selectedChoice = null;

  nextRound();
}

function normalize(s){
  return s
    .toLowerCase()
    .replace(/[.,!?]/g,"")
    .replace(/\s+/g,"")
    .trim();
}

function nextRound(){
  if(round >= items.length){
    document.getElementById("content").innerHTML =
      `<h2>${t("sessionComplete")}</h2>
       <p>${t("score")}: ${score} / ${items.length}</p>
       <button onclick="location.reload()">${t("restart")}</button>`;
    return;
  }

  round++;
  selectedChoice = null;
  document.getElementById("result").innerText="";
  document.getElementById("content").innerHTML="";

  do {
    currentIndex = Math.floor(Math.random()*items.length);
  } while(used.includes(currentIndex));

  used.push(currentIndex);

  if(Math.random()>0.5) buildListen();
  else buildDrag();
}

function buildListen(){
  document.getElementById("mode").innerText = t("listenDecide");

  const correctText = displayText(currentIndex);

  // choose 4 unique indexes
  let optionIndexes = [currentIndex];
  while(optionIndexes.length < 4){
    const r = Math.floor(Math.random() * items.length);
    if(!optionIndexes.includes(r)) optionIndexes.push(r);
  }

  optionIndexes.sort(()=>0.5 - Math.random());

  optionIndexes.forEach(idx=>{
    let div=document.createElement("div");
    div.className="choice";
    div.innerText = displayText(idx);
    div.onclick=()=>{
      document.querySelectorAll(".choice").forEach(c=>c.classList.remove("selected"));
      div.classList.add("selected");
      selectedChoice = displayText(idx);
    };
    document.getElementById("content").appendChild(div);
  });

  let btn=document.createElement("button");
  btn.innerText = t("check");
  btn.onclick=()=>{
    if(!selectedChoice) return;
    if(normalize(selectedChoice)===normalize(correctText)) success();
    else fail();
  };
  document.getElementById("content").appendChild(btn);

  // optional hint: show English under German mode (keeps learning)
  if(nativeLang === "de"){
    const hint = document.createElement("div");
    hint.className = "hint";
    hint.innerText = "English: " + items[currentIndex].en;
    document.getElementById("content").appendChild(hint);
  }
}

function buildDrag(){
  document.getElementById("mode").innerText = t("buildFocus");

  // In German mode, build the German sentence. In English mode, build English.
  const targetSentence = displayText(currentIndex);

  let words = targetSentence.split(" ");
  let shuffled=[...words].sort(()=>0.5-Math.random());

  let top=document.createElement("div");
  top.className="word-container";
  top.id="top";

  let bottom=document.createElement("div");
  bottom.className="word-container";
  bottom.id="bottom";

  shuffled.forEach(w=>{
    let span=document.createElement("div");
    span.className="word";
    span.innerText=w;
    span.onclick=()=>{
      if(span.parentElement.id==="bottom") top.appendChild(span);
      else bottom.appendChild(span);
    };
    bottom.appendChild(span);
  });

  let btn=document.createElement("button");
  btn.innerText = t("check");
  btn.onclick=()=>{
    let built="";
    document.querySelectorAll("#top .word").forEach(w=>built+=w.innerText+" ");
    if(normalize(built)===normalize(targetSentence)) success();
    else fail();
  };

  document.getElementById("content").appendChild(top);
  document.getElementById("content").appendChild(bottom);
  document.getElementById("content").appendChild(btn);

  if(nativeLang === "de"){
    const hint = document.createElement("div");
    hint.className = "hint";
    hint.innerText = "English: " + items[currentIndex].en;
    document.getElementById("content").appendChild(hint);
  }
}

function success(){
  playSound(true);
  score++;
  document.getElementById("result").innerText = (nativeLang === "de") ? "Stark." : "Strong.";
  stopAudio();
  setTimeout(nextRound,1200);
}

function fail(){
  playSound(false);
  document.getElementById("result").innerText = (nativeLang === "de") ? "Reset. Fokus." : "Reset. Focus.";
  stopAudio();
  setTimeout(nextRound,1500);
}

function playAudio(){
  stopAudio();
  // audio files must match item order: audio1.mp3 ... audio14.mp3
  audio=new Audio("audio"+(currentIndex+1)+".mp3");
  audio.play();
}

function stopAudio(){
  if(audio){audio.pause();audio.currentTime=0;}
}

/* Soft sound */
function playSound(success){
  const aCtx=new (window.AudioContext||window.webkitAudioContext)();
  const osc=aCtx.createOscillator();
  const gain=aCtx.createGain();
  osc.connect(gain);
  gain.connect(aCtx.destination);
  osc.frequency.value= success?600:200;
  gain.gain.value=0.05;
  osc.start();
  setTimeout(()=>osc.stop(),100);
}
</script>
</body>
</html>








